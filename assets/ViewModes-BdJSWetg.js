import{R as N,r as a,u as Y,f as B,s as O,j as o,p as A,a as D,b as T,g as F,c as L,i as R,W as H,d as P,e as W,h as G,k as U,l as _}from"./index-DNQ4Dvum.js";function q({items:e,itemHeight:s,windowHeight:t,overscan:l=3,renderItem:u,className:r=""}){const[d,p]=a.useState(0),f=a.useRef(null),n=a.useCallback(j=>{p(j.currentTarget.scrollTop)},[]),{visibleRange:c,totalHeight:m,offsetY:i}=a.useMemo(()=>{const j=Math.max(0,Math.floor(d/s)-l),h=Math.min(e.length-1,Math.ceil((d+t)/s)+l);return{visibleRange:{startIndex:j,endIndex:h},totalHeight:e.length*s,offsetY:j*s}},[d,s,t,e.length,l]),w=a.useMemo(()=>e.slice(c.startIndex,c.endIndex+1),[e,c]);return o.jsx("div",{ref:f,onScroll:n,className:r,style:{height:t,overflow:"auto",position:"relative"},children:o.jsx("div",{style:{height:m,position:"relative"},children:o.jsx("div",{style:{transform:`translateY(${i}px)`},children:w.map((j,h)=>u(j,c.startIndex+h))})})})}const J={small:"calendar-day-small",medium:"calendar-day-medium",large:"calendar-day-large"},I=N.memo(({date:e,mood:s,hasEntry:t,isToday:l,isCurrentMonth:u,size:r="medium",settings:d,onClick:p})=>{const f=e.getDate(),n=e>new Date,c=a.useMemo(()=>U(s,d,n),[s,d,n]),m=a.useCallback(w=>{(w.key==="Enter"||w.key===" ")&&(w.preventDefault(),p())},[p]),i=a.useMemo(()=>["calendar-day-base",J[r],!u&&"calendar-day-not-current-month",n&&"calendar-day-future",t&&!l&&"calendar-day-has-entry"].filter(Boolean).join(" "),[r,u,n,t,l]);return o.jsx("button",{onClick:p,onKeyDown:m,style:c,className:i,"aria-label":`${e.toDateString()}, ${t?"Has entry":"No entry"}`,type:"button",children:r!=="small"&&o.jsx("span",{className:"leading-none",children:f})})}),X=N.memo(({searchQuery:e=""})=>{const s=e.trim().length>0;return o.jsxs("div",{className:"empty-state",children:[o.jsx("div",{className:"empty-state-icon",children:s?"ðŸ”":"ðŸŒ¸"}),o.jsx("h3",{className:"empty-state-title",children:s?"No results found...":"There's nothing here..."}),o.jsx("p",{className:"empty-state-subtitle",children:s?"Try adjusting your search terms.":"Add a mood entry first!"})]})}),Z=N.memo(({date:e,entry:s,onClick:t,settings:l,truncateForDayView:u=!1,showMoodSelector:r=!1})=>{const d=N.useRef(null),[p,f]=N.useState(!1),n=a.useMemo(()=>W(e),[e]),c=a.useMemo(()=>G((s==null?void 0:s.diary)||""),[s==null?void 0:s.diary]),m=a.useMemo(()=>s!=null&&s.diary&&s.diary.length>100?s.diary.substring(0,100)+"...":(s==null?void 0:s.diary)||"",[s==null?void 0:s.diary]);N.useEffect(()=>{u&&d.current&&(s!=null&&s.diary)&&f(d.current.scrollHeight>192)},[u,s==null?void 0:s.diary]);const i=a.useCallback(M=>{(M.key==="Enter"||M.key===" ")&&(M.preventDefault(),t())},[t]),w=a.useCallback(M=>{M.stopPropagation(),t()},[t]),j=a.useMemo(()=>s!=null&&s.mood?l.customColors.moods[s.mood]:l.customColors.moods.grey,[s==null?void 0:s.mood,l.customColors.moods]),h=s!=null&&s.mood?l.customLabels[s.mood]:"No mood selected";return o.jsxs("div",{onClick:t,className:"card-base cursor-pointer hover:shadow-xl transition-all duration-200 hover:scale-[1.02] entry-preview-centered",role:"button",tabIndex:0,onKeyDown:i,"aria-label":`Entry for ${n}${s!=null&&s.diary?": "+m:""}`,children:[o.jsxs("div",{className:"entry-header",children:[o.jsx("h3",{className:"entry-date",children:n}),o.jsx("div",{className:"entry-mood-indicator",children:s||r?o.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 rounded-full",style:{backgroundColor:j},"aria-label":s?`Mood: ${h}`:"No mood selected"}):o.jsx("button",{onClick:w,className:"px-3 py-1.5 bg-white/10 hover:bg-white/20 rounded-lg text-xs transition-colors flex-shrink-0",children:"Add Entry"})})]}),(s==null?void 0:s.diary)&&o.jsx("p",{ref:d,className:`entry-content ${u?`entry-content-truncated ${p?"needs-truncation":""}`:""}`,children:c})]})}),ss=N.memo(({entries:e,onEntryClick:s,searchQuery:t="",settings:l,onViewModeChange:u})=>{const r=a.useRef(null),[d,p]=a.useState(!1),f=a.useCallback(()=>u("month","in"),[u]);Y(r,{onZoomOut:f});const n=a.useMemo(()=>{const m=B(e,t,l);return O(m,!1)},[e,t,l]);a.useEffect(()=>{p(n.length>20)},[n.length]);const c=a.useCallback(m=>o.jsx(Z,{date:A(m.date),entry:m,onClick:()=>s(m),settings:l,truncateForDayView:!0},m.date),[s,l]);return n.length===0?o.jsx("div",{ref:r,"data-zoom-container":!0,className:"calendar-container",role:"list","aria-label":"Mood entries",children:o.jsx(X,{searchQuery:t})}):d?o.jsx("div",{ref:r,"data-zoom-container":!0,className:"calendar-container",role:"list","aria-label":"Mood entries",children:o.jsx(q,{items:n,itemHeight:250,windowHeight:typeof window<"u"?window.innerHeight-200:600,overscan:2,renderItem:m=>o.jsx("div",{className:"mb-3 sm:mb-4",children:c(m)},m.date),className:"space-y-3 sm:space-y-4"})}):o.jsx("div",{ref:r,"data-zoom-container":!0,className:"calendar-container",role:"list","aria-label":"Mood entries",children:o.jsx("div",{className:"space-y-3 sm:space-y-4",children:n.map(c)})})}),es=N.memo(({currentDate:e,entries:s,onEntryEdit:t,onDateChange:l,onViewModeChange:u,settings:r})=>{const d=a.useRef(null),[p,f]=N.useState(null),n=a.useMemo(()=>{const g=new Map;for(let y=0;y<s.length;y++)g.set(s[y].date,s[y]);return g},[s]),c=a.useCallback(g=>n.get(D(g)),[n]),m=a.useCallback(()=>l(T(e,1)),[e,l]),i=a.useCallback(()=>l(T(e,-1)),[e,l]),w=a.useCallback(()=>u("year","in"),[u]),j=a.useCallback(()=>u("day","out"),[u]);Y(d,{onSwipeLeft:m,onSwipeRight:i,onZoomOut:w,onZoomIn:j});const h=a.useMemo(()=>p?c(p):void 0,[p,c]),M=a.useMemo(()=>{const g=F(e),y=L(e),C=y===0?6:y-1,k=[],S=new Date(e.getFullYear(),e.getMonth()-1,1),K=F(S);for(let b=C-1;b>=0;b--){const v=K-b,x=new Date(S.getFullYear(),S.getMonth(),v),E=c(x);k.push(o.jsx(I,{date:x,mood:(E==null?void 0:E.mood)||"grey",hasEntry:!!E,isToday:R(x),isCurrentMonth:!1,settings:r,onClick:()=>f(x)},`prev-${v}`))}for(let b=1;b<=g;b++){const v=new Date(e.getFullYear(),e.getMonth(),b),x=c(v);k.push(o.jsx(I,{date:v,mood:(x==null?void 0:x.mood)||"grey",hasEntry:!!x,isToday:R(v),isCurrentMonth:!0,settings:r,onClick:()=>f(v)},b))}const z=42-k.length,$=new Date(e.getFullYear(),e.getMonth()+1,1);for(let b=1;b<=z;b++){const v=new Date($.getFullYear(),$.getMonth(),b),x=c(v);k.push(o.jsx(I,{date:v,mood:(x==null?void 0:x.mood)||"grey",hasEntry:!!x,isToday:R(v),isCurrentMonth:!1,settings:r,onClick:()=>f(v)},`next-${b}`))}return k},[e,r,c]);return o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{ref:d,"data-zoom-container":!0,className:"card-base p-responsive-lg calendar-container",children:[o.jsx("div",{className:"grid-calendar gap-1 sm:gap-2 lg:gap-3 mb-2 sm:mb-3 lg:mb-4",children:H.map(g=>o.jsx("div",{className:"calendar-weekday",children:g},g))}),o.jsx("div",{className:"grid-calendar gap-1.5 sm:gap-2",children:M})]}),p&&o.jsx("div",{className:"space-responsive-sm",children:o.jsx(Z,{date:p,entry:h,onClick:()=>t(p),settings:r,showMoodSelector:!h})})]})}),V=N.memo(({monthDate:e,entries:s,settings:t,onMonthClick:l})=>{const u=a.useMemo(()=>{const n=new Map;for(let c=0;c<s.length;c++)n.set(s[c].date,s[c]);return n},[s]),r=a.useMemo(()=>{const n=F(e),c=L(e),m=c===0?6:c-1,i=[];for(let h=0;h<m;h++)i.push(o.jsx("div",{className:"w-2 h-2 sm:w-2.5 sm:h-2.5 lg:w-3 lg:h-3"},`empty-${h}`));for(let h=1;h<=n;h++){const M=new Date(e.getFullYear(),e.getMonth(),h),g=u.get(D(M)),y=_(M),C=(g==null?void 0:g.mood)||"grey",k=t.customColors.moods[C],S=y?{backgroundColor:"transparent",border:`2px solid ${k}`}:{backgroundColor:k,border:"none"};i.push(o.jsx("div",{className:"w-2.5 h-2.5 sm:w-3.5 sm:h-3.5 md:w-4 md:h-4 lg:w-5 lg:h-5 xl:w-6 xl:h-6 rounded-full",style:S},h))}const w=42,j=m+n;for(let h=j;h<w;h++)i.push(o.jsx("div",{className:"w-2 h-2 sm:w-2.5 sm:h-2.5 lg:w-3 lg:h-3"},`fill-${h}`));return i},[e,u,t.customColors.moods]),d=a.useCallback(n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),l(e))},[e,l]),p=a.useCallback(()=>l(e),[e,l]),f=a.useMemo(()=>e.toLocaleDateString(void 0,{month:"long"}),[e]);return o.jsxs("button",{onClick:p,onKeyDown:d,className:"mini-month-container p-2 sm:p-2.5 lg:p-3",style:{backgroundColor:t.customColors.base},"aria-label":`View ${f} ${e.getFullYear()}`,type:"button",children:[o.jsx("h3",{className:"mini-month-title",children:f}),o.jsx("div",{className:"mini-month-grid",children:r})]})}),os=N.memo(({currentDate:e,entries:s,onDateChange:t,onViewModeChange:l,settings:u})=>{const r=a.useRef(null),d=e.getFullYear(),p=a.useCallback(()=>{const i=new Date(e);i.setFullYear(d+1),t(i)},[e,d,t]),f=a.useCallback(()=>{const i=new Date(e);i.setFullYear(d-1),t(i)},[e,d,t]),n=a.useCallback(()=>l("month","out"),[l]);Y(r,{onSwipeLeft:p,onSwipeRight:f,onZoomIn:n});const c=a.useCallback(i=>{t(i),l("month",void 0)},[t,l]),m=a.useMemo(()=>P(d),[d]);return o.jsx("div",{ref:r,"data-zoom-container":!0,className:"calendar-container",children:o.jsx("div",{className:"grid-responsive-3-4-6 gap-4 sm:gap-6 lg:gap-8",children:m.map(i=>o.jsx(V,{monthDate:i,entries:s,settings:u,onMonthClick:c},i.getMonth()))})})});export{ss as ViewDay,es as ViewMonth,os as ViewYear};

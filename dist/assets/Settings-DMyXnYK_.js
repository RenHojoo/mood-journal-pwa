import{m as p,r as c,n as ee,o as ae,q as le,D as A,t as oe,j as e,M as N,B as d}from"./index-DNQ4Dvum.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=p("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=p("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=p("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=p("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=p("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=p("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=p("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),ue=({isOpen:F,onClose:R,settings:l,onSettingsChange:s,entries:g,setEntries:w,onDeleteAllData:B,showStatusMessage:t})=>{const[U,f]=c.useState(!1),[o,h]=c.useState(null),[x,L]=c.useState("#000000"),[$,C]=c.useState(!1),[O,j]=c.useState(!1),[y,D]=c.useState(""),q=c.useCallback(()=>{const a=ee(g);if(a.length===0){t("No entries to export.","error");return}const r=new Blob([ae(g)],{type:"text/plain"}),i=URL.createObjectURL(r),n=document.createElement("a");n.href=i;const m=new Date,v=m.getFullYear(),k=String(m.getMonth()+1).padStart(2,"0"),u=String(m.getDate()).padStart(2,"0");n.download=`moodjournal-${v}-${k}-${u}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(i),t(`Exported ${a.length} entries.`)},[g,t]),H=c.useCallback(a=>{var n;const r=(n=a.target.files)==null?void 0:n[0];if(!r)return;if(!r.name.toLowerCase().endsWith(".txt")){t("Please select a .txt file.","error"),a.target.value="";return}if(r.size>1024*1024){t("File too large. Please use a file smaller than 1MB.","error"),a.target.value="";return}const i=new FileReader;i.onload=m=>{var v;try{const k=(v=m.target)==null?void 0:v.result,u=le(k);w(S=>{const K=new Set(u.map(E=>E.date));return[...S.filter(E=>!K.has(E.date)),...u]}),t(`Imported ${u.length} entries.`)}catch(k){const u=k instanceof Error?k.message:"Import failed.";t(`Import failed: ${u}`,"error")}},i.onerror=()=>t("Error reading file. Please try again.","error"),i.readAsText(r),C(!1),a.target.value=""},[w,t]),V=c.useCallback(()=>{const a=document.getElementById("import-file-input");a==null||a.click()},[]),G=c.useCallback(()=>{B(),f(!1),t("All entries deleted.")},[B,t]),z=c.useCallback((a,r)=>{s(a==="base"||a==="accent"||a==="text"?{...l,customColors:{...l.customColors,[a]:r}}:{...l,customColors:{...l.customColors,moods:{...l.customColors.moods,[a]:r}}})},[l,s]),T=c.useCallback(a=>{s({...l,backgroundColor:a})},[l,s]),W=c.useCallback(()=>{s({...l,backgroundImage:void 0})},[l,s]),X=c.useCallback(()=>{s({...l,customColors:A.customColors,customLabels:A.customLabels,backgroundImage:void 0,backgroundColor:void 0}),h(null)},[l,s]),b=c.useCallback(a=>{const r=a==="background"?l.backgroundColor||l.customColors.base:a==="base"||a==="accent"||a==="text"?l.customColors[a]:l.customColors.moods[a];L(r),h(a),j(!1),a!=="background"&&a!=="base"&&a!=="accent"&&a!=="text"&&D(l.customLabels[a])},[l]),Y=c.useCallback(()=>{o&&(o==="background"?T(x):z(o,x),h(null))},[o,x,T,z]),Z=c.useCallback(async a=>{var i;const r=(i=a.target.files)==null?void 0:i[0];if(r){if(r.size>10*1024*1024){t("Image too large. Please use an image smaller than 10MB.","error"),a.target.value="";return}if(!r.type.startsWith("image/")){t("Please select a valid image file.","error"),a.target.value="";return}try{const n=await oe(r,1920,1080,.85);if(n.length>5*1024*1024){t("Compressed image still too large. Please use a smaller image.","error"),a.target.value="";return}s({...l,backgroundImage:n}),t("Background image updated.")}catch(n){const m=n instanceof Error?n.message:"Error processing image";t(`${m}. Please try again.`,"error")}a.target.value=""}},[l,s,t]),_=c.useMemo(()=>o?{background:"Background",base:"Base",accent:"Accent",text:"Text"}[o]||l.customLabels[o]:"",[o,l.customLabels]),M=c.useCallback((a,r)=>{s({...l,customLabels:{...l.customLabels,[a]:r}})},[l,s]),J=c.useCallback(()=>{o&&o!=="background"&&o!=="base"&&o!=="accent"&&o!=="text"&&j(!0)},[o]),I=c.useCallback(()=>{o&&y.trim()&&M(o,y.trim()),j(!1)},[o,y,M]),Q=c.useCallback(a=>{a.key==="Enter"?I():a.key==="Escape"&&(j(!1),o&&D(l.customLabels[o]))},[I,o,l.customLabels]);return e.jsxs(e.Fragment,{children:[e.jsx(N,{isOpen:F,onClose:R,size:"lg",children:e.jsxs("div",{className:"space-responsive-md",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"settings-theme-row",children:[e.jsx("h3",{className:"section-title",children:"Theme Colors"}),e.jsx("button",{onClick:()=>s({...l,isDarkMode:!l.isDarkMode}),className:"theme-toggle",children:e.jsx("div",{className:`theme-toggle-slider ${l.isDarkMode?"theme-toggle-active":""}`,style:{backgroundColor:l.customColors.accent},children:l.isDarkMode?e.jsx(ne,{size:12}):e.jsx(te,{size:12})})}),e.jsxs("button",{onClick:X,className:"settings-reset-button",children:[e.jsx(se,{size:12}),"Reset"]})]}),e.jsx("div",{className:"flex justify-center mb-3",children:e.jsxs("div",{className:"color-grid-main",children:[e.jsx("button",{onClick:()=>b("base"),className:"color-button",style:{backgroundColor:l.customColors.base},title:"Base Color"}),e.jsx("button",{onClick:()=>b("accent"),className:"color-button",style:{backgroundColor:l.customColors.accent},title:"Accent Color"}),e.jsx("button",{onClick:()=>b("background"),className:"color-button cursor-pointer flex-center bg-white/10",title:"Background Color",children:e.jsx(re,{size:12,style:{color:"#bababa"}})}),e.jsx("button",{onClick:()=>b("text"),className:"color-button flex-center text-lg font-bold",style:{fontSize:"24px",fontFamily:"Georgia",color:l.customColors.text},title:"Text Color",children:"A"})]})}),e.jsx("div",{className:"color-grid-moods",children:Object.entries(l.customColors.moods).map(([a,r])=>e.jsx("button",{onClick:()=>b(a),className:"color-button-mood",style:{backgroundColor:r},title:l.customLabels[a]},a))})]}),e.jsxs("div",{className:"settings-section",children:[e.jsx("h3",{className:"section-title mb-3",children:"Data Management"}),e.jsxs("div",{className:"settings-data-section",children:[e.jsxs(d,{variant:"secondary",onClick:q,className:"w-full flex items-center gap-2 justify-center",children:[e.jsx(ce,{size:16}),"Export Data"]}),e.jsxs(d,{variant:"secondary",onClick:()=>C(!0),className:"w-full flex-center gap-2",children:[e.jsx(P,{size:16}),"Import Data"]}),e.jsx("input",{id:"import-file-input",type:"file",accept:".txt",onChange:H,className:"hidden"})]})]}),e.jsx("div",{className:"settings-section",children:e.jsxs(d,{variant:"primary",onClick:()=>f(!0),accentColor:l.customColors.accent,className:"w-full flex-center gap-2",children:[e.jsx(ie,{size:16}),"Delete Data"]})})]})}),e.jsxs(N,{isOpen:!!o,onClose:()=>h(null),size:"sm",showCloseButton:!1,children:[e.jsxs("div",{className:"color-picker-container",children:[e.jsx("div",{className:"color-picker-title",children:"Mood Label"}),O?e.jsx("div",{className:"color-picker-label-wrapper",children:e.jsx("input",{type:"text",value:y,onChange:a=>D(a.target.value),onBlur:I,onKeyDown:Q,className:"color-picker-label-input",autoFocus:!0,maxLength:20})}):e.jsx("div",{className:"color-picker-subtitle",onClick:J,style:{cursor:o&&o!=="background"&&o!=="base"&&o!=="accent"&&o!=="text"?"pointer":"default"},children:_})]}),e.jsx("div",{className:"color-picker-display",children:e.jsx("input",{type:"color",value:x,onChange:a=>L(a.target.value),className:"color-picker-native"})}),e.jsxs("div",{className:"color-picker-input-row",children:[e.jsx("div",{className:"color-picker-preview",style:{backgroundColor:x}}),e.jsx("input",{type:"text",value:x,onChange:a=>L(a.target.value),className:"color-picker-text-input"})]}),o==="background"&&e.jsxs("div",{className:"color-picker-upload-section",children:[e.jsxs("label",{className:"color-picker-upload-button",children:[e.jsx(P,{size:16}),"Upload Image",e.jsx("input",{type:"file",accept:"image/*",onChange:Z,className:"hidden"})]}),l.backgroundImage&&e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:W,className:"color-picker-remove-button",style:{opacity:.7},children:"Remove Background"})})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx(d,{variant:"secondary",onClick:()=>h(null),className:"flex-1",children:"Cancel"}),e.jsx(d,{variant:"primary",onClick:Y,accentColor:l.customColors.accent,className:"flex-1",children:"Apply"})]})]}),e.jsxs(N,{isOpen:U,onClose:()=>f(!1),size:"md",showCloseButton:!1,children:[e.jsxs("div",{className:"confirm-modal-content",children:[e.jsx("div",{className:"confirm-modal-icon",children:"âš ï¸"}),e.jsx("h3",{className:"confirm-modal-title",children:"Delete All Data?"}),e.jsx("p",{className:"confirm-modal-description",children:"All your entries will be permanently deleted from this device. This action cannot be undone (make sure to export a backup)!"})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx(d,{variant:"secondary",onClick:()=>f(!1),className:"flex-1",children:"Cancel"}),e.jsx(d,{variant:"primary",onClick:G,accentColor:l.customColors.accent,className:"flex-1",children:"Delete All"})]})]}),e.jsxs(N,{isOpen:$,onClose:()=>C(!1),size:"md",showCloseButton:!1,children:[e.jsxs("div",{className:"confirm-modal-content",children:[e.jsx("div",{className:"confirm-modal-icon",children:"ðŸ“"}),e.jsx("h3",{className:"confirm-modal-title",children:"Import .TXT File?"}),e.jsx("p",{className:"confirm-modal-description",children:"Select a .txt file from this device. Entries with the same date will be replaced. This action cannot be undone."})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsx(d,{variant:"secondary",onClick:()=>C(!1),className:"flex-1",children:"Cancel"}),e.jsx(d,{variant:"primary",onClick:V,accentColor:l.customColors.accent,className:"flex-1",children:"Select File"})]})]})]})};export{ue as SettingsModal};
